var setSpwSortable;jQuery(document).ready(function(a){setSpwSortable=function(){a(".selected-posts").sortable({stop:function(){b=[],a(this).find(".selected-post").each(function(){b.push(a(this).data("post-id"))}),a(this).closest(".spw-form").find(".post-list").val(JSON.stringify(b))}})};var b=[],c=function(b,c){var d=[],e=b.closest(".spw-form"),f=e.find(".spw-no-selected");b.find(".post-list"),b.val()&&(d=JSON.parse(b.val())),d&&!a.isArray(d)&&(d=[]),d.push(c),f.hide(),b.val(JSON.stringify(d))},d=function(b){var c=[],d=b.find(".spw-no-selected");b.find(".selected-post:visible").each(function(){c.push(a(this).data("post-id"))}),c.length<=0&&d.show(),b.find(".post-list").val(JSON.stringify(c))},e=function(){a(".widgets-holder-wrap").on("click",".spw-plus",function(){var b=a(this).closest(".spw-form"),d=a(this).closest(".search-result"),e=b.find(".post-list"),f=d.data("post-id"),g=b.find(".selected-posts");c(e,f),d.addClass("selected-post").removeClass("search-result"),d.find(".spw-plus").html("-").addClass("spw-minus").removeClass("spw-plus"),g.append(d)}),a(".widgets-holder-wrap").on("click",".spw-minus",function(){var b=a(this).closest(".spw-form"),c=a(this).closest(".selected-post");c.fadeOut(function(){d(b)})}),a(".widgets-holder-wrap").on("keypress",".spw-search",function(b){if(13===b.which){b.preventDefault();var c=a(this).closest(".spw-form");c.find(".spw-search-button").click()}}),a(".widgets-holder-wrap").on("click",".spw-search-button",function(){var b=a(this).closest(".spw-form"),c=b.find(".loading"),d=b.find(".spw-search").val(),e=b.find(".search-results");if(e.html(""),d){var f=b.find(".post-list");c.show();var g={action:"spw_search",query:d,alreadySelected:f.val()};a.post(ajaxurl,g,function(a){e.html(a),c.hide()})}})};e(),setSpwSortable()});