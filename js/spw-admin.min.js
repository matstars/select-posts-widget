var setSpwSortable;jQuery(document).ready(function(a){var b=[];setSpwSortable=function(){a(".selected-posts").sortable({stop:function(){b=[],a(this).find(".selected-post").each(function(){b.push(a(this).data("post-id"))}),a(this).closest(".spw-form").find(".post-list").val(JSON.stringify(b))}})};var c=function(b,c){var d=[],e=b.closest(".spw-form"),f=e.find(".spw-no-selected");b.find(".post-list"),b.val()&&(d=JSON.parse(b.val())),d&&!a.isArray(d)&&(d=[]),d.push(c),f.hide(),b.val(JSON.stringify(d))},d=function(b){var c=[],d=b.find(".spw-no-selected");b.find(".selected-post:visible").each(function(){c.push(a(this).data("post-id"))}),c.length<=0&&d.show(),b.find(".post-list").val(JSON.stringify(c))},e=function(){a("body").on("click",".spw-plus",function(){var b=a(this).closest(".spw-form"),d=a(this).closest(".search-result"),e=b.find(".post-list"),f=d.data("post-id"),g=b.find(".selected-posts");c(e,f),d.addClass("selected-post").removeClass("search-result"),d.find(".spw-plus").html("-").addClass("spw-minus").removeClass("spw-plus"),g.append(d)}),a("body").on("click",".spw-minus",function(){var b=a(this).closest(".spw-form"),c=a(this).closest(".selected-post");c.fadeOut(function(){d(b)})}),a("body").on("keypress",".spw-search",function(b){if(13===b.which){b.preventDefault();var c=a(this).closest(".spw-form"),d=c.find(".loading"),e=c.find(".spw-search").val(),f=c.find(".search-results");if(!e)return;var g=c.find(".post-list");d.show(),f.html("");var h={action:"spw_search",query:e,alreadySelected:g.val()};a.post(ajaxurl,h,function(a){f.html(a),d.hide()})}})};e(),setSpwSortable()});